FROM debian:bookworm-slim
RUN apt-get update && apt-get install -y build-essential libpam0g-dev git

WORKDIR /usr/src
COPY sudo-1.9.17.tar.gz /usr/src/
RUN tar xzf sudo-1.9.17.tar.gz && \
    cd sudo-1.9.17 && \
    ./configure && make && make install

RUN useradd -m ctfuser && echo "ctfuser:ctf" | chpasswd
USER ctfuser
WORKDIR /home/ctfuser
CMD ["/bin/bash"]
